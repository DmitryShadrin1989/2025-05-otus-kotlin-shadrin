# API для проекта «Электронная записная книжка»


## 1. Сущности

**Заметка (Note)**

| Поле | Бизнес‑описание | Пример значения |
|------|---------------|---------------|
| id | Уникальный идентификатор заметки (UUID) | `550e8400-e29b-41d4-a716-446655440000` |
| userId | Идентификатор пользователя, создавшего заметку | `123e4567-e89b-12d3-a456-426614174000` |
| title | Заголовок заметки (максимум 100 символов) | «Купить продукты» |
| content | Текст заметки (неограниченный объём) | «1. Молоко<br>2. Хлеб<br>3. Яйца» |
| category | Категория заметки (строка, опционально) | «Покупки», «Работа», «Личное» |
| reminderAt | Дата и время напоминания (ISO 8601, опционально) | `2025-12-01T10:00:00Z` |
| isDeleted | Флаг удаления (мягкое удаление) | `false` |
| createdAt | Дата создания (автоматически) | `2025-11-30T08:00:00Z` |
| updatedAt | Дата последнего изменения (автоматически) | `2025-11-30T09:30:00Z` |


## 2. Бизнес‑функции (методы)

**CRUD для заметок**

1. **`notes.create`** — Создание новой заметки
    - *Бизнес‑правило*: Только авторизованный пользователь может создавать заметки.
    - *Ограничения*:
        - `title` не может быть пустым (минимум 1 символ).
        - Максимальная длина `title` — 100 символов.
        - Поле `userId` заполняется автоматически из контекста авторизации.

2. **`notes.update`** — Обновление существующей заметки
    - *Бизнес‑правило*: Только владелец заметки может её редактировать.
    - *Ограничения*:
        - Нельзя изменить `id` или `userId`.
        - Поля `createdAt` и `updatedAt` обновляются автоматически.

3. **`notes.read`** — Получение заметки по ID
    - *Бизнес‑правило*: Доступ только для владельца заметки.
    - *Возвращает*: Полный объект заметки или ошибку 404, если заметка не найдена/удалена.

4. **`notes.delete`** — Мягкое удаление заметки
    - *Бизнес‑правило*: Только владелец может удалить заметку.
    - *Эффект*: Поле `isDeleted` устанавливается в `true`, заметка скрывается из списка, но остаётся в БД.
    - *Восстановление*: Через отдельный метод `notes.restore`.

5. **`notes.list`** — Получение списка заметок пользователя
    - *Бизнес‑правило*: Возвращает только заметки текущего пользователя.
    - *Фильтры*:
        - По категории (`category`).
        - По статусу удаления (`isDeleted = false` по умолчанию).
    - *Пагинация*: Поддержка `page` и `size` (например, `page=1&size=10`).

    - *Сортировка*: По `updatedAt` (по умолчанию, новые сверху).

6. **`notes.search`** — Поиск заметок по тексту
    - *Бизнес‑логика*: Поиск по полям `title` и `content`.
    - *Параметры*:
        - `query` — поисковая строка.
        - `category` — фильтр по категории (опционально).
    - *Возвращает*: Список заметок, где `query` встречается в `title` или `content`.

7. **`notes.restore`** — Восстановление удалённой заметки
    - *Бизнес‑правило*: Только владелец может восстановить заметку.
    - *Эффект*: Поле `isDeleted` устанавливается в `false`.


## 3. Бизнес‑правила


1. **Доступ к данным**:
    - Все операции требуют аутентификации (JWT‑токен).
    - Пользователь видит только свои заметки (`userId` должен совпадать).

2. **Управление категориями**:
    - Категории задаются пользователем (свободный ввод).
    - Нет жёсткого списка допустимых категорий.

3. **Напоминания**:
    - Напоминание срабатывает за 15 минут до `reminderAt`.
    - Если `reminderAt` прошло, напоминание не отправляется.
4. **Удаление**:
    - Мягкое удаление (поле `isDeleted`) действует 7 дней.
    - Через 7 дней заметки автоматически удаляются из БД.

5. **Валидация данных**:
    - `email` пользователя проверяется при регистрации.
    - `password` хешируется (bcrypt).

## 4. Бизнес‑метрики успеха

1. **Скорость ответа API**:
    - 95% запросов должны выполняться за < 500 мс.
2. **Доступность**:
    - Uptime ≥ 99.5%.
3. **Безопасность**:
    - Все запросы через HTTPS.
    - Защита от SQL‑инъекций и XSS.
4. **Ограничения**:
    - Максимум 1 000 заметок на пользователя.
    - Лимит 100 запросов/минуту на пользователя (для защиты от спама).